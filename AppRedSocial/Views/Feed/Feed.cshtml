@model IEnumerable<AppRedSocial.Models.Post>

@{
    ViewData["Title"] = "Feed";
}

<h2 class="mb-4">Feed de Publicaciones</h2>

<div class="mb-3">
    <a class="btn btn-primary" asp-controller="Post" asp-action="Create">Crear nueva publicación</a>
</div>

@if (Model == null || !Model.Any())
{
    <p>No hay publicaciones aún.</p>
}
else
{
    foreach (var post in Model)
    {
        <div class="card mb-4">
            <div class="card-body">
                <h4>@post.Title</h4>
                <p>@post.Content</p>

                <small class="text-muted">
                    Publicado por: @post.User?.UserName
                </small>

                <hr />

                <h6>Comentarios:</h6>

                @if (post.Comments == null || !post.Comments.Any())
                {
                    <p class="text-muted">No hay comentarios en esta publicación.</p>
                }
                else
                {
                    foreach (var c in post.Comments)
                    {
                        <div class="border p-2 mb-2 rounded">
                            <strong>@c.User?.UserName:</strong> @c.Content
                        </div>
                    }
                }

                <div class="mt-3">
                    <a class="btn btn-sm btn-outline-primary"
                       asp-controller="Post"
                       asp-action="Details"
                       asp-route-id="@post.Id">Ver Detalles</a>

                    <a class="btn btn-sm btn-outline-success"
                       asp-controller="Comment"
                       asp-action="Create"
                       asp-route-postId="@post.Id">Comentar</a>
                </div>
            </div>
        </div>
    }
}

